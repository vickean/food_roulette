<script src='https://maps.googleapis.com/maps/api/js?v=3.exp'></script>

<% if @user == current_user || (Preferences.find_by(preferer_id: current_user.id, preferee_id: @user.id).pefer && Preferences.find_by(preferer_id: @user.id, preferee_id: current_user.id).pefer) %>

<h1>Users#show</h1>
<p>Find me in app/views/users/show.html.erb</p>


<div class="container">
<div class="jumbotron text-center">
<h1> Welcome to Your Profile </h1>

<div class="avatar">
	<% if current_user.avatar != nil %>
		<%=image_tag current_user.avatar%>
	<% else %>
		<%=image_tag("empty_avatar.png")%>
	<% end %>
</div>
<br>

<p>
	<strong>First name:</strong>
	<%=@user.first_name%>
</p>

<p>
	<strong>Last name:</strong>
	<%=@user.last_name%>
</p>

<p>
	<strong>Email:</strong>
	<%=@user.email%>
</p>

<p>
	<strong>Gender:</strong>
	<%=@user.gender%>
</p>
<% if current_user == @user %>
<p>

	<strong>number of spins:</strong>
	<%= @user.spin_num %>
</p>
<%end%>


</div>
</div>
<%else%>
<p>
	You dont have premission to view this page
</p>
<%end%>

	<strong>Location:</strong>
	<%= current_user.address %><br>
	<div style='overflow:hidden;height:500px;width:1000px;'>
	  <div id='gmap_canvas' style='height:500px;width:800px;'></div>
	  <style>#gmap_canvas img{
	    max-width:none!important;
	    background:none!important
	    }
	  </style>
	</div>

</div>

</div>
<%= javascript_tag do %>

  function init_map(){

    var myOptions = {
      zoom:17,center:new google.maps.LatLng(<%= @user.latitude %>,<%= @user.longitude %>),
      mapTypeId: google.maps.MapTypeId.ROADMAP
    };

  map = new google.maps.Map(document.getElementById('gmap_canvas'), myOptions);

  marker = new google.maps.Marker({
    map: map,position: new google.maps.LatLng(<%= @user.latitude %>,<%= @user.longitude %>)
  });

  infowindow = new google.maps.InfoWindow({
    content:'<strong><%= @user.first_name %></strong><br><%= @user.address %><br>'
  });

  google.maps.event.addListener(marker, 'click', function(){
    infowindow.open(map,marker);
  });

  infowindow.open(map,marker);}google.maps.event.addDomListener(window, 'load', init_map);

<% end %>
